<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registro | Aprende Franc√©s con David Jaramillo</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet" />

  <style>
    body {
      font-family: 'Poppins', sans-serif;
      background: linear-gradient(135deg, #1e3a8a, #2563eb, #3b82f6);
      background-size: 300% 300%;
      animation: gradientMove 12s ease-in-out infinite;
      color: #1e293b;
    }

    @keyframes gradientMove {
      0% { background-position: 0% 0%; }
      50% { background-position: 100% 100%; }
      100% { background-position: 0% 0%; }
    }

    .register-card {
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(12px);
      border-radius: 1rem;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s ease;
    }

    .register-card:hover {
      transform: translateY(-2px);
    }

    .input-field {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 1px solid #d1d5db;
      border-radius: 0.5rem;
      background: white;
      color: #1f2937;
      outline: none;
      transition: all 0.2s ease;
    }

    .input-field:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }

    .btn-primary {
      width: 100%;
      background-color: #2563eb;
      color: white;
      font-weight: 600;
      padding: 0.75rem;
      border-radius: 0.5rem;
      box-shadow: 0 2px 6px rgba(37, 99, 235, 0.4);
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background-color: #1d4ed8;
    }

    .btn-secondary {
      width: 100%;
      background-color: #e5e7eb;
      color: #1f2937;
      font-weight: 500;
      padding: 0.75rem;
      border-radius: 0.5rem;
      margin-top: 0.5rem;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background-color: #d1d5db;
    }

    .btn-external {
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.75rem;
      background-color: white;
      border: 1px solid #d1d5db;
      color: #374151;
      font-weight: 500;
      border-radius: 0.5rem;
      padding: 0.75rem;
      transition: all 0.3s ease;
    }

    .btn-external:hover {
      background-color: #f3f4f6;
    }

    .btn-external img {
      width: 24px;
      height: 24px;
    }

    #formMessage {
      margin-top: 0.75rem;
      font-size: 0.9rem;
      min-height: 1.5em;
    }
  </style>
</head>

<body class="min-h-screen flex items-center justify-center px-4">
  <div class="register-card p-8 w-full max-w-md text-center">
    <h1 class="text-3xl font-bold text-blue-700 mb-2">
      Apprends le fran√ßais <span class="text-gray-800 text-lg font-semibold">FR</span> üá´üá∑
    </h1>
    <p class="text-gray-600 mb-6">
      Reg√≠strate para comenzar tu camino hacia el dominio del franc√©s.
    </p>

    <!-- FORMULARIO -->
    <form id="registerForm" class="space-y-4 text-center">
      <input type="text" id="name" class="input-field" placeholder="Nombre completo" required />
      <input type="email" id="email" class="input-field" placeholder="Correo electr√≥nico" required />
      <input type="password" id="password" class="input-field" placeholder="Contrase√±a" required />

      <button type="submit" class="btn-primary mt-2">Registrarme</button>
    </form>

    <!-- Bot√≥n de login -->
    <button id="loginBtn"
      class="w-full bg-gray-100 border border-gray-300 hover:bg-gray-200 text-gray-700 font-medium py-3 rounded-lg transition-all duration-300 mt-2 shadow-sm">
      Usuario ya registrado
    </button>

    <!-- Mensaje din√°mico -->
    <p id="formMessage" class="text-gray-600 mt-3"></p>

    <!-- Bot√≥n de continuar sin registrarse -->
    <a href="Index.html" class="block mt-3">
      <button class="btn-secondary">Avanzar sin registrarme</button>
    </a>

    <!-- Separador -->
    <div class="flex items-center my-6">
      <hr class="flex-grow border-gray-300" />
      <span class="px-2 text-gray-500 text-sm">o</span>
      <hr class="flex-grow border-gray-300" />
    </div>

    <!-- Bot√≥n de Google -->
    <button id="googleBtn" class="btn-external">
      <img src="https://www.svgrepo.com/show/475656/google-color.svg" alt="Google" />
      <span>Registrarme con Google</span>
    </button>

    <!-- Enlace de inicio de sesi√≥n -->
    <p class="text-sm text-gray-500 mt-6">
      ¬øTienes problemas? <a href="#" class="text-blue-600 hover:underline font-medium">Contacta soporte</a>
    </p>
  </div>

  <!-- Script de conexi√≥n -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const form = document.getElementById("registerForm");
      const loginBtn = document.getElementById("loginBtn");
      const messageBox = document.getElementById("formMessage");

      const API_BASE = "https://webfrancais-backend.onrender.com/api/auth";

      const showMessage = (msg, type = "info") => {
        messageBox.textContent = msg;
        messageBox.className =
          type === "success"
            ? "text-green-600 font-semibold"
            : type === "error"
            ? "text-red-600 font-semibold"
            : "text-gray-700";
      };

      // Registro
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const name = document.getElementById("name").value.trim();
        const email = document.getElementById("email").value.trim();
        const password = document.getElementById("password").value.trim();

        if (!name || !email || !password) {
          showMessage("‚ö†Ô∏è Completa todos los campos.", "error");
          return;
        }

        try {
          showMessage("‚è≥ Registrando usuario...");
          const res = await fetch(`${API_BASE}/register`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ name, email, password }),
          });

          const data = await res.json();

          if (res.ok) {
            showMessage(`‚úÖ Registro exitoso. Bienvenido, ${data.user.name}!`, "success");
            setTimeout(() => (window.location.href = "Index.html"), 1500);
          } else {
            showMessage(`‚ùå ${data.message}`, "error");
          }
        } catch (err) {
          console.error(err);
          showMessage("‚ö†Ô∏è Error de conexi√≥n con el servidor.", "error");
        }
      });

      // Login
      loginBtn.addEventListener("click", async () => {
        const email = prompt("Ingresa tu correo electr√≥nico:");
        const password = prompt("Ingresa tu contrase√±a:");

        if (!email || !password) {
          showMessage("‚ö†Ô∏è Debes ingresar ambos campos.", "error");
          return;
        }

        try {
          showMessage("‚è≥ Verificando usuario...");
          const res = await fetch(`${API_BASE}/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await res.json();

          if (res.ok) {
            showMessage(`‚úÖ Bienvenido de nuevo, ${data.user.name}!`, "success");
            setTimeout(() => (window.location.href = "Index.html"), 1500);
          } else {
            showMessage(`‚ùå ${data.message}`, "error");
          }
        } catch (err) {
          console.error(err);
          showMessage("‚ö†Ô∏è No se pudo conectar con el servidor.", "error");
        }
      });
    });
  </script>
</body>
</html>
